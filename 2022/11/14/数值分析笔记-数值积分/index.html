<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="fonts.useso.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"seanzhou0616.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.13.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="数值积分引入 对于连续函数 \(f(x)\) 来说，如果这个函数的表达式比较简单，我们一般可以使用Newton-Leibniz公式进行积分 \[ \int_a^b f(x)dx &#x3D; F(b) - F(a) \] 其中，\(F&#39;(x)&#x3D;f(x)\)，即 \(F(x)\) 是 \(f(x)\) 的原函数。 使用Newton-Leibniz公式进行积分其实是非常理想的情况。假如函数 \(f(x)">
<meta property="og:type" content="article">
<meta property="og:title" content="数值分析笔记-数值积分">
<meta property="og:url" content="http://seanzhou0616.github.io/2022/11/14/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86/">
<meta property="og:site_name" content="Elysium">
<meta property="og:description" content="数值积分引入 对于连续函数 \(f(x)\) 来说，如果这个函数的表达式比较简单，我们一般可以使用Newton-Leibniz公式进行积分 \[ \int_a^b f(x)dx &#x3D; F(b) - F(a) \] 其中，\(F&#39;(x)&#x3D;f(x)\)，即 \(F(x)\) 是 \(f(x)\) 的原函数。 使用Newton-Leibniz公式进行积分其实是非常理想的情况。假如函数 \(f(x)">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://seanzhou0616.github.io/2022/11/14/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86//Snipaste_2022-11-16_11-47-11.png">
<meta property="og:image" content="http://seanzhou0616.github.io/2022/11/14/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86//Gauss-Legendre.png">
<meta property="og:image" content="http://seanzhou0616.github.io/2022/11/14/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86//Gauss-Laguerre.png">
<meta property="og:image" content="http://seanzhou0616.github.io/2022/11/14/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86//Gauss-Hermite.png">
<meta property="article:published_time" content="2022-11-14T13:43:41.000Z">
<meta property="article:modified_time" content="2022-11-16T07:10:26.854Z">
<meta property="article:author" content="Sean Zhou">
<meta property="article:tag" content="Numerical Analysis">
<meta property="article:tag" content="Mathematics">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://seanzhou0616.github.io/2022/11/14/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86//Snipaste_2022-11-16_11-47-11.png">


<link rel="canonical" href="http://seanzhou0616.github.io/2022/11/14/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://seanzhou0616.github.io/2022/11/14/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86/","path":"2022/11/14/数值分析笔记-数值积分/","title":"数值分析笔记-数值积分"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>数值分析笔记-数值积分 | Elysium</title>
  






  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Elysium</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Tech, Race, Game</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86%E5%BC%95%E5%85%A5"><span class="nav-number">1.</span> <span class="nav-text">数值积分引入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86%E8%AF%AF%E5%B7%AE%E4%BC%B0%E8%AE%A1"><span class="nav-number">2.</span> <span class="nav-text">数值积分误差估计</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B1%82%E7%A7%AF%E5%85%AC%E5%BC%8F"><span class="nav-number">3.</span> <span class="nav-text">求积公式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%AD%E7%82%B9%E5%85%AC%E5%BC%8F"><span class="nav-number">3.1.</span> <span class="nav-text">中点公式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E7%82%B9%E5%85%AC%E5%BC%8F%E7%9A%84%E8%AE%A1%E7%AE%97"><span class="nav-number">3.1.1.</span> <span class="nav-text">中点公式的计算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E7%82%B9%E5%85%AC%E5%BC%8F%E7%9A%84%E8%AF%AF%E5%B7%AE%E5%88%86%E6%9E%90"><span class="nav-number">3.1.2.</span> <span class="nav-text">中点公式的误差分析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A2%AF%E5%BD%A2%E5%85%AC%E5%BC%8F"><span class="nav-number">3.2.</span> <span class="nav-text">梯形公式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A2%AF%E5%BD%A2%E5%85%AC%E5%BC%8F%E7%9A%84%E8%AE%A1%E7%AE%97"><span class="nav-number">3.2.1.</span> <span class="nav-text">梯形公式的计算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A2%AF%E5%BD%A2%E5%85%AC%E5%BC%8F%E7%9A%84%E8%AF%AF%E5%B7%AE%E5%88%86%E6%9E%90"><span class="nav-number">3.2.2.</span> <span class="nav-text">梯形公式的误差分析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#simpson%E5%85%AC%E5%BC%8F"><span class="nav-number">3.3.</span> <span class="nav-text">Simpson公式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#simpson%E5%85%AC%E5%BC%8F%E7%9A%84%E8%AE%A1%E7%AE%97"><span class="nav-number">3.3.1.</span> <span class="nav-text">Simpson公式的计算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#simpson%E5%85%AC%E5%BC%8F%E7%9A%84%E8%AF%AF%E5%B7%AE%E4%BC%B0%E8%AE%A1"><span class="nav-number">3.3.2.</span> <span class="nav-text">Simpson公式的误差估计</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%82%E7%A7%AF%E5%85%AC%E5%BC%8F%E4%B8%80%E8%88%AC%E5%8C%96"><span class="nav-number">3.4.</span> <span class="nav-text">求积公式一般化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%8D%E5%90%88%E6%B1%82%E7%A7%AF"><span class="nav-number">4.</span> <span class="nav-text">复合求积</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%AD%E7%82%B9%E5%A4%8D%E5%90%88%E6%B1%82%E7%A7%AF"><span class="nav-number">4.1.</span> <span class="nav-text">中点复合求积</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A2%AF%E5%BD%A2%E5%A4%8D%E5%90%88%E6%B1%82%E7%A7%AF"><span class="nav-number">4.2.</span> <span class="nav-text">梯形复合求积</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#simpson%E5%A4%8D%E5%90%88%E6%B1%82%E7%A7%AF"><span class="nav-number">4.3.</span> <span class="nav-text">Simpson复合求积</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8A%E8%BF%B0%E5%A4%8D%E5%90%88%E6%B1%82%E7%A7%AF%E5%85%AC%E5%BC%8F%E7%9A%84%E8%AF%AF%E5%B7%AE%E5%88%86%E6%9E%90"><span class="nav-number">4.4.</span> <span class="nav-text">上述复合求积公式的误差分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E7%82%B9%E5%A4%8D%E5%90%88%E6%B1%82%E7%A7%AF%E8%AF%AF%E5%B7%AE"><span class="nav-number">4.4.1.</span> <span class="nav-text">中点复合求积误差</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A2%AF%E5%BD%A2%E5%A4%8D%E5%90%88%E6%B1%82%E7%A7%AF%E8%AF%AF%E5%B7%AE"><span class="nav-number">4.4.2.</span> <span class="nav-text">梯形复合求积误差</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#simpson%E5%A4%8D%E5%90%88%E6%B1%82%E7%A7%AF%E8%AF%AF%E5%B7%AE"><span class="nav-number">4.4.3.</span> <span class="nav-text">Simpson复合求积误差</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%98%E6%AD%A5%E9%95%BF%E6%96%B9%E6%B3%95%E4%BB%A5%E5%8F%8A%E5%A4%96%E6%8E%A8%E5%8A%A0%E9%80%9F%E6%8A%80%E6%9C%AF"><span class="nav-number">5.</span> <span class="nav-text">变步长方法以及外推加速技术</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%BA%E9%97%B4%E6%8A%98%E5%8D%8A%E6%B3%95"><span class="nav-number">5.1.</span> <span class="nav-text">区间折半法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#romberg%E6%B1%82%E7%A7%AF"><span class="nav-number">5.2.</span> <span class="nav-text">Romberg求积</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#newton-cotes%E5%85%AC%E5%BC%8F"><span class="nav-number">6.</span> <span class="nav-text">Newton-Cotes公式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#cotes%E7%B3%BB%E6%95%B0"><span class="nav-number">6.1.</span> <span class="nav-text">Cotes系数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#newton-cotes%E5%85%AC%E5%BC%8F%E7%9A%84%E8%AF%AF%E5%B7%AE"><span class="nav-number">6.2.</span> <span class="nav-text">Newton-Cotes公式的误差</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E6%96%AF%E5%85%AC%E5%BC%8F"><span class="nav-number">7.</span> <span class="nav-text">高斯公式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%AB%98%E6%96%AF%E5%85%AC%E5%BC%8F%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="nav-number">7.1.</span> <span class="nav-text">高斯公式的定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E9%AB%98%E6%96%AF%E7%82%B9"><span class="nav-number">7.2.</span> <span class="nav-text">寻找高斯点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B%E7%A7%8D%E5%B8%B8%E7%94%A8%E7%9A%84%E9%AB%98%E6%96%AF%E7%A7%AF%E5%88%86%E5%85%AC%E5%BC%8F"><span class="nav-number">7.3.</span> <span class="nav-text">四种常用的高斯积分公式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#gauss-legendre%E5%85%AC%E5%BC%8F"><span class="nav-number">7.3.1.</span> <span class="nav-text">Gauss-Legendre公式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#gauss-chebyshev%E5%85%AC%E5%BC%8F"><span class="nav-number">7.3.2.</span> <span class="nav-text">Gauss-Chebyshev公式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#gauss-laguerre%E5%85%AC%E5%BC%8F"><span class="nav-number">7.3.3.</span> <span class="nav-text">Gauss-Laguerre公式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#gauss-hermite%E5%85%AC%E5%BC%8F"><span class="nav-number">7.3.4.</span> <span class="nav-text">Gauss-Hermite公式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%AB%98%E6%96%AF%E5%85%AC%E5%BC%8F%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-number">7.3.5.</span> <span class="nav-text">高斯公式使用注意事项</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Sean Zhou"
      src="/images/Yeah.jpg">
  <p class="site-author-name" itemprop="name">Sean Zhou</p>
  <div class="site-description" itemprop="description">Sean Zhou's personal blog.</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">20</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/SeanZhou0616" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;SeanZhou0616" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:seanzhou616@gmail.com" title="E-Mail → mailto:seanzhou616@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://seanzhou0616.github.io/2022/11/14/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/Yeah.jpg">
      <meta itemprop="name" content="Sean Zhou">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Elysium">
      <meta itemprop="description" content="Sean Zhou's personal blog.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="数值分析笔记-数值积分 | Elysium">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          数值分析笔记-数值积分
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-11-14 21:43:41" itemprop="dateCreated datePublished" datetime="2022-11-14T21:43:41+08:00">2022-11-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-11-16 15:10:26" itemprop="dateModified" datetime="2022-11-16T15:10:26+08:00">2022-11-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/University/" itemprop="url" rel="index"><span itemprop="name">University</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="数值积分引入">数值积分引入</h2>
<p>对于连续函数 <span class="math inline">\(f(x)\)</span> 来说，如果这个函数的表达式比较简单，我们一般可以使用Newton-Leibniz公式进行积分</p>
<p><span class="math display">\[
\int_a^b f(x)dx = F(b) - F(a)
\]</span></p>
<p>其中，<span class="math inline">\(F&#39;(x)=f(x)\)</span>，即 <span class="math inline">\(F(x)\)</span> 是 <span class="math inline">\(f(x)\)</span> 的原函数。</p>
<p>使用Newton-Leibniz公式进行积分其实是非常理想的情况。假如函数 <span class="math inline">\(f(x)\)</span> 的表达式非常复杂，或是根本就不可积，或是根本没有表达式，仅仅是给出了某些节点上的函数值，那么我们就只能通过数值积分的方式进行近似的积分求解了。</p>
<span id="more"></span>
<h2 id="数值积分误差估计">数值积分误差估计</h2>
<p>对于函数 <span class="math inline">\(f(x)\in C[a, b]\)</span>，假如存在一个 <span class="math inline">\(n\)</span> 阶多项式 <span class="math inline">\(P_n(x)\)</span>，可以近似有 <span class="math inline">\(f(x) \approx P_n(x)\)</span>，那么应能近似得到</p>
<p><span class="math display">\[
\int_a^bf(x)dx \approx \int_a^bP_n(x)dx
\]</span></p>
<p>对于上述数值积分，其误差是可以估计的。</p>
<p><span class="math display">\[
\int_a^bf(x)dx - \int_a^bP_n(x)dx = \int_a^b[f(x)-P_n(x)]dx=\int_a^bR_n(x)dx
\]</span></p>
<p>如果有 <span class="math inline">\(max_{a\leq x \leq b}R_n(x)\leq \varepsilon\)</span>，那么显然，上述数值积分的误差限为</p>
<p><span class="math display">\[
\int_a^bR_n(x)dx \leq (b-a)\varepsilon
\]</span></p>
<p>如果 <span class="math inline">\(\varepsilon\)</span> 很小的话，数值积分的误差限也很小，那么使用数值积分来近似真实的积分值，完全是可行的。</p>
<h2 id="求积公式">求积公式</h2>
<h3 id="中点公式">中点公式</h3>
<h4 id="中点公式的计算">中点公式的计算</h4>
<p>近似求积分的一种非常自然的想法，是使用一个矩形围成的面积来近似函数曲线在区间上与x轴所围成的面积。这种做数值积分的方式可以概括为中点公式。若 <span class="math inline">\(f(x) \in C[a,b]\)</span>，那么</p>
<p><span class="math display">\[
\int_a^bf(x)dx \approx (b-a)f(\frac{a+b}{2})
\]</span></p>
<p>利用区间中点对应的函数值乘以区间长度，得到的矩形面积，近似函数积分。</p>
<h4 id="中点公式的误差分析">中点公式的误差分析</h4>
<p>对于上述近似，可以进行近似误差的估计。假设函数 <span class="math inline">\(f(x)\)</span> 在区间 <span class="math inline">\([a, b]\)</span> 上二阶可导，那么根据泰勒公式</p>
<p><span class="math display">\[
f(x) = f(\frac{a+b}{2}) + f&#39;(\frac{a+b}{2})(x-\frac{a+b}{2}) + \frac{f&#39;&#39;(\xi)}{2}(x-\frac{a+b}{2})^2
\]</span></p>
<p>对上述等式两边做积分，可以得到</p>
<p><span class="math display">\[
\int_a^bf(x)dx-(b-a)f(\frac{a+b}{2}) = \frac{1}{24}(b-a)^3f&#39;&#39;(\xi)
\]</span></p>
<p>也就是说，中点公式的误差差不多就是在 <span class="math inline">\((b-a)^3\)</span> 量级。</p>
<h3 id="梯形公式">梯形公式</h3>
<h4 id="梯形公式的计算">梯形公式的计算</h4>
<p>梯形公式是另一种非常自然的近似积分想法。从图形上来看，就是将 <span class="math inline">\(f(a)\)</span> 与 <span class="math inline">\(f(b)\)</span> 相连，形成一条直线，然后计算这条线段在 <span class="math inline">\([a, b]\)</span> 上的积分。</p>
<p><span class="math display">\[
\int_a^bf(x)dx = \frac{1}{2}(b-a)[f(a)+f(b)]
\]</span></p>
<h4 id="梯形公式的误差分析">梯形公式的误差分析</h4>
<p>梯形公式涉及到一条一次拟合多项式，因此可以用一次多项式拟合的误差来计算梯形公式的误差，如下</p>
<p><span class="math display">\[
R_1(x) = f(x) - L_1(x) = \frac{1}{2}f&#39;&#39;(\xi)(x-a)(x-b)
\]</span></p>
<p>那么</p>
<p><span class="math display">\[
\int_a^bf(x)dx - \int_a^bL_1(x)dx = \int_a^bR_1(x) = -\frac{1}{12}(b-a)^3f&#39;&#39;(\xi)
\]</span></p>
<p>分析到这里，可能出现了比较反直觉的一点性质，即梯形公式的误差似乎要比中点公式的误差还要大，后者的系数是 <span class="math inline">\(\frac{1}{24}\)</span>。</p>
<h3 id="simpson公式">Simpson公式</h3>
<h4 id="simpson公式的计算">Simpson公式的计算</h4>
<p>Simpson公式，也叫抛物型公式。这种数值积分方式实际上就是在区间上用一条抛物线来近似积分，即</p>
<p><span class="math display">\[
\int_a^bf(x)dx \approx \int_a^bL_2(x)dx=\frac{1}{6}(b-a)[f(a) + 4f(\frac{a+b}{2}) + f(b)]
\]</span></p>
<h4 id="simpson公式的误差估计">Simpson公式的误差估计</h4>
<p>和梯形公式类似的，Simpson公式的近似误差也可以通过二次多项式的误差估计得到。由于二次多项式的误差分析展开比较复杂，也不是什么重点，这边的笔记就略去了，最后可以得到</p>
<p><span class="math display">\[
\int_a^bf(x)dx - \int_a^bL_2(x)dx = -\frac{(b-a)^5}{2880}f^{(4)}(\xi)
\]</span></p>
<p>可以观察到，Simpson公式的近似误差量级是 <span class="math inline">\((b-a)^5\)</span>，比梯形公式和中点公式的近似误差要小两个量级。事实上，Simpson近似积分的精度确实要比前面两种高很多。</p>
<h3 id="求积公式一般化">求积公式一般化</h3>
<p>观察中点公式、梯形公式和Simpson公式，可以发现一个共同点：这些公式都可以写成 <span class="math inline">\(\sum_{i=0}^{n-1}\omega_if(x_i)\)</span> 的形式。因此，上面的这些公式都可以称为求积公式。</p>
<p>求积公式有一个叫做<strong>代数精度</strong>的指标。所谓代数精度，指的是这个求积公式最高能够对多少次的多项式精确求积分。若某个求积公式对于 <span class="math inline">\(m\)</span> 阶多项式 <span class="math inline">\(x^m\)</span> 都可以满足精确求解的要求，但是对于 <span class="math inline">\(m+1\)</span> 阶多项式就不满足精确求积分的要求，那么这个求积公式的代数精度就为 <span class="math inline">\(m\)</span> 次。</p>
<h2 id="复合求积">复合求积</h2>
<p>前面提到，数值积分的误差与区间长度有关，像中间公式的积分误差与区间长度的3次方呈正相关关系，Simpson公式的积分误差与区间长度的5次方呈正相关关系。那么，为了减小数值积分的误差，就必须减小区间长度。事实上，对于 <span class="math inline">\(f(x) \in C[a, b]\)</span>，我们往往会将区间 <span class="math inline">\([a, b]\)</span> 等分为 <span class="math inline">\(n\)</span> 份，在一个小区间 <span class="math inline">\([x_i, x_{i+1}]\)</span> 上进行求积，即</p>
<p><span class="math display">\[
\int_a^bf(x)dx = \sum_{i=0}^{n-1}\int_{x_i}^{x_{i+1}}f(x)dx
\]</span></p>
<p>一般来说，我们会将小区间的长度称为<strong>积分步长</strong>，用符号 <span class="math inline">\(h\)</span> 表示。</p>
<p><span class="math display">\[
h = \frac{b-a}{n}
\]</span></p>
<h3 id="中点复合求积">中点复合求积</h3>
<p>对一个小区间内的积分进行数值近似，可以得到</p>
<p><span class="math display">\[
\int_{x_i}^{x_{i+1}}f(x)dx=(x_{i+1}-x_i)f(x_{i+\frac{1}{2}})=hf(x_{i+\frac{1}{2}})
\]</span></p>
<p>那么，整个区间的积分即</p>
<p><span class="math display">\[
\int_a^bf(x)dx = \sum_{i=0}^{n-1}hf(x_{i+\frac{1}{2}}) \triangleq M_n
\]</span></p>
<h3 id="梯形复合求积">梯形复合求积</h3>
<p>同上，很容易得到</p>
<p><span class="math display">\[
\int_a^bf(x)dx = \sum_{i=0}^{n-1}\frac{h}{2}[f(x_i)+f(x_{i+1})] = \frac{h}{2}[f(a)+f(b)+2\sum_{i=1}^{n-1}f(x_i)] \triangleq T_n
\]</span></p>
<h3 id="simpson复合求积">Simpson复合求积</h3>
<p><span class="math display">\[
\int_a^bf(x)dx = \sum_{i=0}^{n-1}\frac{h}{6}[f(x_i) + f(x_{i+1}) + 4f(x_{i+\frac{1}{2}})]=\frac{h}{6}[f(a) + f(b) + 4\sum_{i=1}^{n-1}f(x_{i+\frac{1}{2}})+2\sum_{i=1}^{n-1}f(x_i)] \triangleq S_n
\]</span></p>
<h3 id="上述复合求积公式的误差分析">上述复合求积公式的误差分析</h3>
<p>为了进行上述复合求积公式的误差限分析，首先引入一个定理：对于 <span class="math inline">\(f(x) \in C[a, b]\)</span>，存在一点 <span class="math inline">\(\eta \in (a, b)\)</span>，满足 <span class="math inline">\(\sum_{i=0}^{n-1}\omega_if(x_i)=f(\eta)\sum_{i=0}^{n-1}\omega_i\)</span>。</p>
<p>这个定理的求证其实非常简单。对于 <span class="math inline">\(f(x) \in C[a, b]\)</span>，必然存在一个 <span class="math inline">\(f_{min}\)</span> 和一个 <span class="math inline">\(f_{max}\)</span>，很自然有</p>
<p><span class="math display">\[
f_{min}\sum_{i=0}^{n-1}\omega_i \leq \sum_{i=0}^{n-1}\omega_i f(x_i) \leq f_{max}\sum_{i=0}^{n-1}\omega_i
\]</span></p>
<p>由于 <span class="math inline">\(f(x)\)</span> 在区间 <span class="math inline">\([a, b]\)</span> 上连续，那么必然存在某一个 <span class="math inline">\(f\)</span>，恰好满足</p>
<p><span class="math display">\[
f\sum_{i=0}^{n-1}\omega_i=\sum_{i=0}^{n-1}\omega_i f(x_i)
\]</span></p>
<h4 id="中点复合求积误差">中点复合求积误差</h4>
<p>有了上面这个定理，求复合求积误差就很容易了。对于</p>
<p><span class="math display">\[
\sum_{i=0}^{n-1}\int_{x_i}^{x_{i+1}}f(x)dx = h\sum_{i=0}^{n-1}f(x_{i+\frac{1}{2}})
\]</span></p>
<p>作差，得到</p>
<p><span class="math display">\[
\sum_{i=0}^{n-1}[\int_{x_i}^{x_{i+1}}f(x)dx-hf(x_{i+\frac{1}{2}})]
\]</span></p>
<p>注意到求和公式内部是一个中点求积误差的表达式，代入可得</p>
<p><span class="math display">\[
\sum_{i=0}^{n-1}[\int_{x_i}^{x_{i+1}}f(x)dx - hf(x_{i+\frac{1}{2}})]=\sum_{i=0}^{n-1}\frac{1}{24}h^3f&#39;&#39;(\xi)
\]</span></p>
<p>注意到，求和项与 <span class="math inline">\(i\)</span> 无关，因此可以得到中点复合求积误差为</p>
<p><span class="math display">\[
\frac{b-a}{24}h^2f&#39;&#39;(\xi)
\]</span></p>
<h4 id="梯形复合求积误差">梯形复合求积误差</h4>
<p><span class="math display">\[
-\frac{b-a}{12}h^2f&#39;&#39;(\xi)
\]</span></p>
<h4 id="simpson复合求积误差">Simpson复合求积误差</h4>
<p><span class="math display">\[
-\frac{b-a}{2880}h^4f&#39;&#39;(\xi)
\]</span></p>
<p>可以观察到，复合求积误差本质上就是将原来的 <span class="math inline">\((b-a)\)</span> 替换为 <span class="math inline">\(h\)</span>，但其中一次因为 <span class="math inline">\(n\)</span> 项求和退化为 <span class="math inline">\((b-a)\)</span>，因此原来是 <span class="math inline">\((b-a)^m\)</span> 量级的误差都变为 <span class="math inline">\(h^{m-1}\)</span> 量级。</p>
<p>中点复合求积以及梯形复合求积的误差都是 <span class="math inline">\(O(h^2)\)</span> 量级的，而Simpson复合求积的误差是 <span class="math inline">\(O(h^4)\)</span> 量级的，因此如果对于近似精度要求较高，应尽量选择使用Simpson复合求积。</p>
<h2 id="变步长方法以及外推加速技术">变步长方法以及外推加速技术</h2>
<p>前面所介绍的求积方法都是定步长的方法。定步长数值积分编程很容易，但是确定步长是一件比较麻烦的事情。如果步长定得太大，精度就会比较差；如果步长定得太小，计算效率可能就低很多。因此，变步长方法被引入到数值积分中。下面通过一个简单的变步长方法，初步了解一下变步长数值积分的基本原理。</p>
<h3 id="区间折半法">区间折半法</h3>
<p>变步长积分的主要思想是，对于给定的积分精度，一开始可以在整个区间上进行数值积分，若精度达不到要求，则将积分步长减半；不断地将积分步长减半，直到积分精度满足给定要求为止。</p>
<p>以梯形求积为例，若记 <span class="math inline">\(I = \int_a^bf(x)dx\)</span>，那么</p>
<p><span class="math display">\[
|I-T_n| = \frac{1}{12}(b-a)h^2f&#39;&#39;(\xi)
\]</span></p>
<p>如果进行了一次区间折半，得到 <span class="math inline">\(T_{2n}\)</span>，那么应有</p>
<p><span class="math display">\[
|I-T_{2n}| = \frac{1}{12}(b-a)(\frac{h}{2})^2f&#39;&#39;(\xi)
\]</span></p>
<p>如果忽略两个误差项中的 <span class="math inline">\(f&#39;&#39;(\xi)\)</span> 上的细微误差，基本上可以认为</p>
<p><span class="math display">\[
|I-T_{2n}| = \frac{1}{4}|I-T_n|
\]</span></p>
<p>也就是说，一次区间折半大约可以提升四倍精度。另外，可以通过 <span class="math inline">\(|T_n-T_{2n}|\)</span> 来估算 <span class="math inline">\(I-T_{2n}\)</span> 的水平。因为 <span class="math inline">\(|I-T_{2n}|\approx\frac{1}{4}|I-T_n|\)</span>，因此，基本上可以认为</p>
<p><span class="math display">\[
|I - T_{2n}| = \frac{1}{3}|T_n-T_{2n}|
\]</span></p>
<p>所以，区间折半法进行数值积分时，可以以 <span class="math inline">\(|T_n-T_{2n}|\)</span> 的水平来判断变步长数值积分的精度是否已经符合要求。</p>
<h3 id="romberg求积">Romberg求积</h3>
<p>虽然区间折半法原理很简单，编程也很容易实现，但是精度收敛还是太慢了，这会导致要想实现高精度的数值积分，不得不将 <span class="math inline">\(h\)</span> 缩放到一个很小的水平，那么 <span class="math inline">\(n\)</span> 就会变得很大，导致计算量快速上升。Richardson搞出了一种外推加速的方法，利用这种方法进行数值计算的方式称为Romberg求积。</p>
<p>Romberg求积需要用到Euler-MacLaurin公式，但是我并不想在这里引入这个复杂的公式，其实对于说明Romberg求积而言不是很有必要。</p>
<p>简单来说，引入Euler-MacLaurin公式的目的是为了说明</p>
<p><span class="math display">\[
T_n - I = a_1 h^2 + a_2 h^4 + ...
\]</span></p>
<p>对于上面这条等式，如果进行一次区间折半，可以得到</p>
<p><span class="math display">\[
T_{2n} - I = a_1(\frac{h}{2})^2 + a_2 (\frac{h}{2})^4 + ...
\]</span></p>
<p>为了构造出一个性质更好的求积项，将 <span class="math inline">\(T_n - I\)</span> 乘以 <span class="math inline">\(\frac{1}{4}\)</span>，然后用上式做减法，可以得到</p>
<p><span class="math display">\[
T_{2n} - \frac{3}{4}I - \frac{1}{4}T_n = \bar a_2 h^4 + ...
\]</span></p>
<p>上式可以通过等号两边同时乘以 <span class="math inline">\(\frac{4}{3}\)</span>，改写为</p>
<p><span class="math display">\[
T_n^{(2)} - I = \tilde a_2 h^4 + ...
\]</span></p>
<p>改写为这种形式的意义在于，我们构造出了 <span class="math inline">\(T_n^{(2)}\)</span> 这一项精度更高的近似积分项，这一项实际上等于</p>
<p><span class="math display">\[
T_n^{(2)} = \frac{T_{2n} - 2^{-2}T_n}{1-2^{-2}}
\]</span></p>
<p>也就是说，通过一次区间折半，我们能够将精度提高 <span class="math inline">\(\displaystyle\frac{1}{h^2}\)</span> 倍！这效果无疑远优于区间折半法，因为普通的区间折半一次只能提升大约4倍的精度，而通过Romberg求积，一次区间折半能将精度提升 <span class="math inline">\(\displaystyle\frac{1}{h^2}\)</span> 倍，这意味着Romberg求积的收敛速度是越来越快的，因为随着区间的折半 <span class="math inline">\(h\)</span> 也在不断减小。</p>
<p>事实上，Romberg求积项可以一般化为</p>
<p><span class="math display">\[
T_n^{(m)} = \frac{T_{2n}^{(m-1)}-2^{-2m}T_n^{(m-1)}}{1-2^{-2m}}
\]</span></p>
<p>注意上标并不是求导的意思，这表示的是Romberg求积区间折半的次数。</p>
<h2 id="newton-cotes公式">Newton-Cotes公式</h2>
<p>前面的中点公式、梯形公式以及Simpson公式分别可以看作使用常数、一次函数、二次函数在区间上进行插值，利用插值函数的积分作为原函数的积分替代。对这种方法进行进一步的推广，将 <span class="math inline">\(f(x)\)</span> 用 <span class="math inline">\(n+1\)</span> 个<strong>等距节点</strong>上的 <span class="math inline">\(n\)</span> 次拉格朗日插值多项式替代，然后进行积分，就可以得到 <strong>Newton-Cotes公式</strong>。</p>
<p>具体的推导过程如下：若区间 <span class="math inline">\([a, b]\)</span> 上存在 <span class="math inline">\(n+1\)</span> 个等距节点 <span class="math inline">\(x_i\)</span>，记 <span class="math inline">\(x = a+th, t \in [0, n]\)</span>，可以将 <span class="math inline">\(n\)</span> 次拉格朗日插值多项式 <span class="math inline">\(L_n(x)\)</span> 表示为</p>
<p><span class="math display">\[
L_n(x) = \sum_{i=0}^n (\prod_{j=0, j\neq i}^n \frac{x-x_j}{x_i-x_j})f(x_i)
\]</span></p>
<p>将 <span class="math inline">\(x=a+th\)</span> 代入，可以得到</p>
<p><span class="math display">\[
L_n(x) = \sum_{i=0}^n [\prod_{j=0, j\neq i}^n \frac{(a+th)-(a+jh)}{(a+ih) - (a+jh)}]f(x_i)= \sum_{i=0}^n (\prod_{j=0, j\neq i}^n\frac{t-j}{i-j})f(x_i)
\]</span></p>
<p>观察 <span class="math inline">\(\prod_{j=0, j\neq i}^n \frac{1}{i-j}\)</span> 项，发现可以写成阶乘的形式 <span class="math inline">\(\frac{(-1)^{n-i}}{i!(n-i)!}\)</span>，那么</p>
<p><span class="math display">\[
L_n(x) = \sum_{i=0}^n \frac{(-1)^{n-i}}{i!(n-i)!}(\prod_{j=0, j\neq i}^n(t-j))f(x_i)
\]</span></p>
<p>由于 <span class="math inline">\(f(x) \approx L_n(x)\)</span>，那么</p>
<p><span class="math display">\[
\int_a^bf(x)dx \approx \int_a^b L_n(x)dx
\]</span></p>
<p>观察到 <span class="math inline">\(L_n(x)\)</span> 实际上已经写作了 <span class="math inline">\(L_n(t)\)</span> 的形式，所以对积分式可以进行一次换元</p>
<p><span class="math display">\[
dx = hdt
\]</span></p>
<p>代入积分式，可以得到</p>
<p><span class="math display">\[
\int_a^bL_n(x)dx = (b-a)\sum_{i=0}^n\frac{(-1)^{n-i}}{ni!(n-i)!}(\int_0^n\prod_{j=0, j\neq i}^n(t-j)dt)f(x_i)
\]</span></p>
<p>这条式子计算起来还是比较复杂的，但可以观察到，这条式子中 <span class="math inline">\(f(x_i)\)</span> 之前的部分只与区间长度以及等距节点的数量有关，那么其实可以把前面这一部分系数直接用求积系数 <span class="math inline">\(\omega_i\)</span> 来表示，所以最后仍然可以表示为下面这样的形式</p>
<p><span class="math display">\[
\int_a^bf(x)dx \approx \sum_{i=0}^n \omega_i f(x_i)
\]</span></p>
<p>Newton-Cotes公式的简化写法其实指明了数值积分的精髓，即<em>对求积节点对应的函数值与求积系数的积求和</em>。</p>
<h3 id="cotes系数">Cotes系数</h3>
<p>观察到，求积系数 <span class="math inline">\(\omega_i\)</span> 实际上也可以写成两个部分，即</p>
<p><span class="math display">\[
\omega_i = (b-a) \sum_{i=0}^n\frac{(-1)^{n-i}}{ni!(n-i)!} \int_0^n\prod_{j=0, j\neq i}^n(t-j)dt = (b-a) C_i^{(n)}
\]</span></p>
<p><span class="math inline">\(C_i^{(n)}\)</span> 这一项被称为 <strong>Cotes系数</strong>。由于积分时进行了一次换元，所以Cotes系数的积分区间线性变换至 <span class="math inline">\([0, n]\)</span> 上，成为了只与节点数量有关的项。那么只需事先计算好不同节点数量下的Cotes系数，就可以很方便地使用Newton-Cotes公式进行数值积分了。</p>
<p>实际上中点公式、梯形公式或Simpson公式对应的求积系数就是 <span class="math inline">\(n\)</span> 分别为0,1,2时的Cotes系数。下面给出 <span class="math inline">\(n\leq 8\)</span> 时的Cotes系数表。</p>
<figure>
<img src="/2022/11/14/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86//Snipaste_2022-11-16_11-47-11.png" alt><figcaption>Cotes系数表</figcaption>
</figure>
<p>Cotes系数具有以下性质</p>
<ol type="1">
<li>Cotes系数随着 <span class="math inline">\(i\)</span> 的增大体现出对称性</li>
<li><span class="math inline">\(\sum_{i=0}^nC_i^{(n)}=1\)</span></li>
<li>Cotes系数在 <span class="math inline">\(n\geq 8\)</span> 时有正有负，这会导致数值积分的不稳定，所以一般在实际使用Newton-Cotes公式进行数值积分时 <span class="math inline">\(n\leq 7\)</span></li>
<li>Newton-Cotes公式在 <span class="math inline">\(n\)</span> 为奇数时代数精度至少为 <span class="math inline">\(n\)</span> 次，<span class="math inline">\(n\)</span> 为偶数时代数精度至少为 <span class="math inline">\(n+1\)</span> 次</li>
</ol>
<h3 id="newton-cotes公式的误差">Newton-Cotes公式的误差</h3>
<p>考虑到 <span class="math inline">\(f(x_i)\)</span> 有时可能只是测量值，与真值之间也存在误差。假如 <span class="math inline">\(f(x_i)\)</span> 与真值之间的最大误差为 <span class="math inline">\(\varepsilon\)</span>，那么Newton-Cotes公式进行数值积分的最大误差为 <span class="math inline">\((b-a)\varepsilon\)</span>。</p>
<h2 id="高斯公式">高斯公式</h2>
<p>前面考虑的数值积分都是在等距节点上进行求积，下面介绍一种精度更高的非等距节点求积方法——<strong>高斯积分</strong>。</p>
<h3 id="高斯公式的定义">高斯公式的定义</h3>
<p>高斯公式的定义中引入了权函数，是在区间上进行带权积分</p>
<p><span class="math display">\[
\int_a^b\rho(x)f(x)dx \approx \sum_{i=0}^n \omega_if(x_i)
\]</span></p>
<p>另外，高斯积分对于积分节点是有要求的，满足相应要求的积分节点称为 <strong>高斯点</strong>；积分节点与对应的积分系数之间存在确定关系，这个对应的积分系数称为 <strong>高斯系数</strong>。高斯积分的特征在于，在 <span class="math inline">\(n+1\)</span> 个非等距节点上，能够实现代数精度高达 <span class="math inline">\(2n+1\)</span> 次的数值积分。</p>
<p>要推导任意节点数量的高斯公式非常复杂，但是如果能够先找到高斯点，然后求出对应的高斯系数，就可以直接确定一条高斯积分公式。其中，找高斯点是最困难的一件事。</p>
<h3 id="寻找高斯点">寻找高斯点</h3>
<p>对于高斯点，存在以下定理：</p>
<p>区间 <span class="math inline">\([a, b]\)</span> 上的 <span class="math inline">\(n+1\)</span> 个点均为高斯点的充要条件是，这些点所形成的多项式 <span class="math inline">\(\Pi(x) = \prod_{i=0}^n(x-x_i)\)</span> 在区间上与任意次数不超过 <span class="math inline">\(n\)</span> 次的多项式 <span class="math inline">\(q(x)\)</span> 带权正交，即</p>
<p><span class="math display">\[
\int_a^b \rho(x) \Pi(x) q(x)dx = 0
\]</span></p>
<p>这条定理的证明稍微有点麻烦，对应用来说也不太重要，见教材。这条定理的意义在于说明了高斯点其实就是区间 <span class="math inline">\([a, b]\)</span> 上的 <span class="math inline">\(n+1\)</span> 次带权正交多项式的零点。在多项式章节中介绍了四种不同的正交多项式</p>
<ul>
<li>Legendre正交多项式</li>
<li>Chebyshev正交多项式</li>
<li>Laguerre正交多项式</li>
<li>Hermite正交多项式</li>
</ul>
<p>这四种正交多项式可以与高斯积分定义式结合，形成四种不同的高斯积分公式。在介绍这四种积分公式之前，还要补充3点高斯积分的性质：</p>
<ol type="1">
<li>高斯积分是所有利用 <span class="math inline">\(n+1\)</span> 个积分节点进行积分的方式中，代数精度最高的积分算法</li>
<li>高斯积分的所有积分系数均大于0，因此积分结果一定是稳定的</li>
<li>高斯积分在 <span class="math inline">\(n\rightarrow \infty\)</span> 时，积分结果一定是收敛的</li>
</ol>
<p>前面两点性质基于以下定理：利用 <span class="math inline">\(n+1\)</span> 个积分节点进行数值积分的最高代数精度是 <span class="math inline">\(2n+1\)</span> 次，而且当积分精度达到 <span class="math inline">\(2n+1\)</span> 次时，积分系数 <span class="math inline">\(\omega_i &gt;0\)</span>。</p>
<p>这些性质的证明都不是特别复杂，但是对于数值分析这门课而言不是特别重要，因此不花费过多的精力在讨论性质的证明上。</p>
<h3 id="四种常用的高斯积分公式">四种常用的高斯积分公式</h3>
<h4 id="gauss-legendre公式">Gauss-Legendre公式</h4>
<p>Legendre正交多项式是区间 <span class="math inline">\([-1, 1]\)</span> 上权函数为 <span class="math inline">\(\rho(x) \equiv 1\)</span> 的正交多项式。</p>
<p><span class="math inline">\(n=0\)</span> 时，Gauss-Legendre公式为</p>
<p><span class="math display">\[
\int_{-1}^1f(x)dx \approx 2f(0)
\]</span></p>
<p><span class="math inline">\(n=1\)</span> 时，Gauss-Legendre公式为</p>
<p><span class="math display">\[
\int_{-1}^1f(x)dx \approx f(-\frac{1}{\sqrt{3}}) + f(\frac{1}{\sqrt{3}})
\]</span></p>
<p><span class="math inline">\(n=2\)</span> 时，Gauss-Legendre公式为</p>
<p><span class="math display">\[
\int_{-1}^1f(x)dx \approx \frac{5}{9}f(-\sqrt{\frac{3}{5}}) + \frac{8}{9}f(0) + \frac{5}{9}f(\sqrt{\frac{3}{5}})
\]</span></p>
<figure>
<img src="/2022/11/14/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86//Gauss-Legendre.png" alt><figcaption>Gauss-Legendre公式常用的高斯点及其高斯系数</figcaption>
</figure>
<p>对于计算来说，这一部分内容也不太需要进行定理的推导和证明，只需要记住一些常用的高斯点和高斯系数，然后知道这些点和系数与各公式之间的对应关系，会算简单数值积分即可。</p>
<h4 id="gauss-chebyshev公式">Gauss-Chebyshev公式</h4>
<p>Chebyshev正交多项式是区间 <span class="math inline">\([-1, 1]\)</span> 上权函数为 <span class="math inline">\(\rho(x)=\frac{1}{\sqrt{1-x^2}}\)</span> 的正交多项式。Chebyshev的零点表达式如下</p>
<p><span class="math display">\[
x_i = cos\frac{2i+1}{2(n+1)}\pi, i = 0, 1, ..., n
\]</span></p>
<p>相应的高斯系数为</p>
<p><span class="math display">\[
\omega_i = \frac{\pi}{n+1}
\]</span></p>
<p>Gauss-Chebyshev公式中的所有高斯系数都是相同的！而且高斯点的表达式也很好记忆，因此很容易使用Gauss-Chebyshev公式进行 <span class="math inline">\(n\)</span> 很大时的高斯积分！不过需要注意，Gauss-Chebyshev公式的权函数并不为1，因此应用时应看清楚场合，不然算出来的结果是错的。</p>
<p>Gauss-Chebyshev公式整理如下</p>
<p><span class="math display">\[
\int_{-1}^1\frac{1}{\sqrt{1-x^2}}f(x)dx = \frac{\pi}{n+1}\sum_{i=0}^n f(cos\frac{2i+1}{2(n+1)}\pi)
\]</span></p>
<h4 id="gauss-laguerre公式">Gauss-Laguerre公式</h4>
<p>Laguerre正交多项式是区间 <span class="math inline">\([0, \infty)\)</span> 上权函数为 <span class="math inline">\(\rho(x)=e^{-x}\)</span> 的正交多项式。</p>
<p><span class="math inline">\(n=0\)</span> 时，Gauss-Laguerre公式为</p>
<p><span class="math display">\[
\int_0^{\infty}e^{-x}f(x)dx \approx f(1)
\]</span></p>
<p><span class="math inline">\(n=1\)</span> 时，Gauss-Laguerre公式为</p>
<p><span class="math display">\[
\int_0^{\infty}e^{-x}f(x)dx \approx \frac{2+\sqrt{2}}{4}f(2-\sqrt{2})+\frac{2+\sqrt{2}}{4}f(2+\sqrt{2})
\]</span></p>
<figure>
<img src="/2022/11/14/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86//Gauss-Laguerre.png" alt><figcaption>Gauss-Laguerre公式常用的高斯点及其高斯系数</figcaption>
</figure>
<h4 id="gauss-hermite公式">Gauss-Hermite公式</h4>
<p>Hermite正交多项式是区间 <span class="math inline">\([-\infty, \infty]\)</span> 上权函数为 <span class="math inline">\(\rho(x) = e^{-x^2}\)</span> 的正交多项式。</p>
<p><span class="math inline">\(n=1\)</span> 时，Gauss-Hermite公式为</p>
<p><span class="math display">\[
\int_{-\infty}^{\infty} e^{-x^2}f(x)dx \approx \frac{\sqrt{\pi}}{2}f(-\frac{\sqrt{2}}{2}) + \frac{\sqrt{\pi}}{2}f(\frac{\sqrt{2}}{2})
\]</span></p>
<p><span class="math inline">\(n=2\)</span> 时，Gauss-Hermite公式为</p>
<p><span class="math display">\[
\int_{-\infty}^{\infty} e^{-x^2}f(x)dx \approx \frac{\sqrt{\pi}}{6}f(-\frac{\sqrt{6}}{2})+\frac{2\sqrt{\pi}}{3}f(0) + \frac{\sqrt{\pi}}{6}f(\frac{\sqrt{6}}{2})
\]</span></p>
<figure>
<img src="/2022/11/14/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86//Gauss-Hermite.png" alt><figcaption>Gauss-Hermite公式常用的高斯点及其高斯系数</figcaption>
</figure>
<h4 id="高斯公式使用注意事项">高斯公式使用注意事项</h4>
<p>应用高斯公式时，首先要观察权函数 <span class="math inline">\(\rho(x)\)</span>，其次要观察积分区间。一般来说，根据权函数就可以确定一个积分问题需要用什么积分公式，积分区间和权函数往往是挂钩的。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Numerical-Analysis/" rel="tag"># Numerical Analysis</a>
              <a href="/tags/Mathematics/" rel="tag"># Mathematics</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/11/11/Rust%E5%85%A5%E9%97%A8-%E7%BB%93%E6%9E%84%E4%BD%93/" rel="prev" title="Rust入门-结构体">
                  <i class="fa fa-chevron-left"></i> Rust入门-结构体
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/11/14/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E4%BD%9C%E4%B8%9A-%E7%AC%AC%E4%BA%94%E7%AB%A0/" rel="next" title="数值分析作业-第五章">
                  数值分析作业-第五章 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sean Zhou</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>



  <script src="/js/third-party/fancybox.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
